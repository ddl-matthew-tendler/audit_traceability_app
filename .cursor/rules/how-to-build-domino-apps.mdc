---
name: how-to-build-domino-apps
description: This is a rule that describes how to build domino apps, best practices, api guidelines and technical constraints, UI, components, etc.
---

# basic stack
Apps should be architected as basic python back-end (using fast API) and javascript / html / css front-end. 

Avoid inline styles and javascript and use statically referenced files for that kind of thing.

# UI components and theme
The theme should be light themed, and follow a look and feel similar to the Domino UI experience. Styles and components to replicate the theme can be found inside the example_domino_frontend_code folder.


## Header / Top Navigation Bar

Reference: `example_domino_frontend_code/frontend/packages/base-components/src/TopNavBar/styles.ts`

- **Height**: 44px
- **Background color**: `#2E2E38` (neutralDark700)
- **Text color**: `#FFFFFF` (white)
- **Hover background**: `#40404F` (neutralDark600)

## Color Palette

Reference: `example_domino_frontend_code/frontend/packages/core/src/styled/colors.ts`

### Primary Purple Scale
- purple50: `#F0EEFC`
- purple100: `#D1CBF6`
- purple500: `#543FDE` (primary)
- purple600: `#3B23D1` (primary hover)

### Status Colors
- Active/Success: `#28A464` (green700), background `#EFFBF5` (green50)
- Complete/Info: `#0070CC` (blue700), background `#EBF6FF` (blue50)
- Archived/Neutral: `#65657B` (neutralDark400), background `#F5F5F5` (neutralLight300)
- Warning: `#CCB718` (yellow700), background `#FDFBEB` (yellow50)

### Neutral Colors
- Text primary: `#2E2E38` (neutralDark700)
- Text secondary: `#65657B` (neutralDark400)
- Text muted: `#8F8FA3` (neutralDark200)
- Border light: `#E0E0E0` (neutralLight500)
- Background light: `#FAFAFA` (neutralLight100)

## Typography

Reference: `example_domino_frontend_code/frontend/packages/core/src/styled/base-styles.json`

```css
font-family: 'Roboto', 'Lato', 'Helvetica Neue', Helvetica, Arial, sans-serif;
line-height: 1.5715;
```

## Logo

Use `domino-logo.svg` from project root. This contains the Domino wordmark with starburst icon.

Reference implementation: `example_domino_frontend_code/frontend/packages/core/src/icons/DominoLabelIcon.tsx`

Recommended header logo height: 32px

## Top level nav

Do not make fake top level nav items unless the app actually has real destinations for those nav items.

## React components

If possible, use (or copy) UI components for field elements, filters, etc from the included code in the subfolder: example_domino_frontend_code

But rather than using a full React application with JSX/TSX and a build step, it should use React with React.createElement() calls directly in vanilla JavaScript and be as lightweight as possible, only use components as we need them. Definitely re-use any styling you can find as part of that example_domino_frontend_code (but don't rely on referencing tha for the real app, it's a reference and will eventually get deleted before deploying the app).

If a relevant component can't be found in example_domino_frontend_code feel free to use one from the Ant Design library: https://ant.design/components/overview

## charts
Charts should use the highcharts js library if charts are ever needed. 

# fast API routes and html / js urls
Because when running an app inside domino its behind an nginx proxy that modifies the root url, the app can't rely on absolute url paths to make calls to its backend. Consider using relative or dynamic URLs or detect the path so these calls work.

# Domino API calls

## Authentication

Domino API requests are authenticated using a bearer token that when running within the platform can be retrieved using response = requests.get("http://localhost:8899/access-token") and is used to make API calls using a header:  headers = {"Authorization": token} and if the token starts with Bearer we need to include that.

Re-acquire that access token on EVERY api call because it expires very quickly. 

If API_KEY_OVERRIDE env var is present than use that instead (because running outside domino), this can be used instead and is a long lasting API key we can use outside of domino for the same API requests and is used using the header name: X-Domino-Api-Key

## API Documentation & Base Paths

There are TWO separate swagger files with DIFFERENT base paths:

1. **Platform APIs** (`swagger.json`):
   - Base path: `/v4/`
   - Example: `{DOMINO_API_HOST}/v4/jobs?projectId=...`
   - Includes: Jobs, Projects, Users, Workspaces, etc.

2. **Governance APIs** (`governance_swagger.json`):
   - Base path: `/api/governance/v1/`
   - Example: `{DOMINO_API_HOST}/api/governance/v1/bundles?project_id=...`
   - Includes: Bundles, Policies, Attachments, etc.

**IMPORTANT**: Do NOT add an `/api/` prefix to the v4 platform endpoints. The swagger.json `servers` section shows `/v4` and that is the correct base path to use directly.

## Swagger Caveats

The swagger files may not be 100% accurate:
- Not all documented query parameters actually work (e.g., `sort_by` and `order_by` on the jobs endpoint do not work)
- Test API calls manually before assuming swagger parameters are correct
- If an API returns HTML instead of JSON, it usually means authentication failed - check your headers

## Environment Variables

These environment variables are provided by the Domino platform when running inside Domino:
- `DOMINO_API_HOST` - The base URL for Domino API calls
- `DOMINO_PROJECT_ID` - The current project's ID
- `DOMINO_PROJECT_NAME` - The current project's name
- `DOMINO_PROJECT_OWNER` - The project owner's username

Do not add mock/fake data if the API isn't working and instead prompt the user to set the needed env variables manually if we suspect the app is running locally and not from inside the domino platform yet.

# Running the app
The app should run via an app.sh script and be sure to bind to 0.0.0.0 and the web UI should be accessible via port 8888 by default.